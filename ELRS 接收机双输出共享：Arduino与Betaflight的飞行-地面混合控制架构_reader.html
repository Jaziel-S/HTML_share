<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ELRS æ¥æ”¶æœºåŒè¾“å‡ºå…±äº«ï¼šArduinoä¸Betaflightçš„é£è¡Œ-åœ°é¢æ··åˆæ§åˆ¶æ¶æ„.md</title>
<style>
    :root { color-scheme: light dark; --toc-width: 300px; }
    html, body { height: 100%; }
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans", "Microsoft YaHei", Arial, sans-serif;
        line-height: 1.6;
        background: #fff; color: #000;
    }

    #toggle-toc {
      position: fixed;
      top: 10px;       /* å›ºå®šåƒç´ ä½ç½® */
      left: 10px;      /* å›ºå®šåƒç´ ä½ç½® */
      z-index: 3000;
      font-size: 14px;     /* å›ºå®šåƒç´ å¤§å° */
      padding: 6px 12px;   /* å›ºå®šåƒç´ å†…è¾¹è· */
      background: #007acc;
      color: #fff;
      border: none;
      border-radius: 6px;   /* å›ºå®šåƒç´ åœ†è§’ */
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,.15);
    }


    /* å›ºå®šç›®å½•ï¼šå®é™…å®½åº¦ä»¥ offsetWidth ä¸ºå‡†ï¼ˆJS åŒæ­¥åˆ° --toc-widthï¼‰ */
    nav {
        position: fixed; top: 0; left: 0; bottom: 0;
        width: var(--toc-width);
        box-sizing: border-box; /* åŒ…å«è¾¹æ¡†ä¸æ»šåŠ¨æ¡ */
        overflow-y: auto;
        padding: 48px 1rem 1rem 1rem; /* é¡¶éƒ¨ç•™å‡ºæŒ‰é’®ç©ºé—´ */
        border-right: 1px solid #ddd;
        background: #f9f9f9;
        z-index: 2000;
        transform: translateX(0);
        transition: transform .25s ease;
    }
    body.toc-collapsed nav { transform: translateX(-100%); }

    /* æ­£æ–‡ï¼šä»¥ padding-left é¿å¼€ç›®å½•ï¼Œæ°¸ä¸è¢«è¦†ç›–ï¼›å·¦å³å„ç•™ 1em */
    main {
        min-height: 100%;
        box-sizing: border-box;
        padding: 2rem 1em;
        padding-left: calc(var(--toc-width) + 1em); /* è®©å‡ºç›®å½•å®½åº¦ + 1em */

        transition: padding-left .25s ease;
    }
    body.toc-collapsed main { padding-left: 1em; } /* æ”¶èµ·ç›®å½•æ—¶å…¨å± */

    /* ç›®å½•æ ‘æ ·å¼ä¸æŠ˜å ç®­å¤´ */
    .toc { list-style: none; padding-left: 0; margin: 0; }
    .toc ul { list-style: none; padding-left: 1rem; margin: 0; }
    .toc li.has-children > a::before {
        content: 'â–¸'; display: inline-block; margin-right: 6px;
        transform: rotate(0deg); transition: transform .2s ease;
    }
    .toc li.open > a::before { transform: rotate(90deg); }
    .toc a {
        display: inline-block; padding: 4px 0;
        color: inherit; text-decoration: none;
        word-break: break-word;
    }

    /* å†…å®¹æ ·å¼ */
    img { max-width: 100%; height: auto; display: block; margin: 1rem auto; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 8px; overflow-x: auto; }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

    /* è¡¨æ ¼æ ·å¼ */
    table {
      border-collapse: collapse;
      width: 100%;
      margin: 1rem 0;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5em;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
      font-weight: bold;
    }

    /* æš—è‰²æ¨¡å¼ä¸‹çš„è¡¨æ ¼æ ·å¼ */
    @media (prefers-color-scheme: dark) {
      th, td { border-color: #555; }
      th { background-color: #222; color: #eee; }
    }

    /* æš—è‰²æ¨¡å¼ */
    @media (prefers-color-scheme: dark) {
        body { background: #121212; color: #e0e0e0; }
        nav { background: #1e1e1e; border-right: 1px solid #444; }
        pre { background: #1e1e1e; color: #e0e0e0; }
        code { color: #ffcc66; }
        #toggle-toc { background: #444; }
    }

    /* å°å±ï¼šç›®å½•æŠ½å±‰è¦†ç›–ï¼Œæ­£æ–‡ä¸ç¼©è¿›ï¼›æŒ‰é’®ä»å›ºå®š */
    @media (max-width: 768px) {
        main { padding-left: 1em; }
        nav { box-shadow: 0 0 12px rgba(0,0,0,.25); padding-top: 48px; }
    }
    </style>
</head>
<body class="toc-expanded">
<button id="toggle-toc">â˜° ç›®å½•</button>
<nav><ul class='toc'><li><a href='#elrs-arduinobetaflight'>ELRS æ¥æ”¶æœºåŒè¾“å‡ºå…±äº«ï¼šArduinoä¸Betaflightçš„é£è¡Œ/åœ°é¢æ··åˆæ§åˆ¶æ¶æ„</a></li><ul><li><a href='#_1'>ğŸ“Œ ç¡¬ä»¶ç»“æ„</a></li><li><a href='#arduinocrsf'>æµ‹è¯•ä»£ç ï¼šArduinoè¯»å–CRSFé€šé“çš„å€¼</a></li><li><a href='#pca9685'>èˆµæœºæ§åˆ¶ï¼š<strong>PCA9685èˆµæœºæ‰©å±•æ¿</strong></a></li><ul><li><a href='#pca9685-03-pwm'><strong>PCA9685 é€šé“ 0â€“3</strong> â†’ å››ä¸ªåœ°é¢ç”µæœºé©±åŠ¨ PWM è¾“å…¥</a></li><li><a href='#_2'>æ§åˆ¶é€»è¾‘ï¼š</a></li></ul><li><a href='#_3'>å®Œæ•´ä»£ç ï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰</a></li><li><a href='#_4'>ğŸ“Œ æ¥çº¿è¯´æ˜</a></li><li><a href='#_5'>è¡¥å……</a></li></ul></ul></nav>
<main><h1 id="elrs-arduinobetaflight">ELRS æ¥æ”¶æœºåŒè¾“å‡ºå…±äº«ï¼šArduinoä¸Betaflightçš„é£è¡Œ/åœ°é¢æ··åˆæ§åˆ¶æ¶æ„</h1>
<p>æ¥æ”¶æœº TX â†’ é£æ§ RX + Arduino RXï¼›æ¥æ”¶æœº RX â† é£æ§ TX</p>
<ul>
<li>
<p><strong>ä¸€ä¸ª ELRS æ¥æ”¶æœº</strong>ï¼Œå®ƒçš„ <strong>TX ä¿¡å·çº¿</strong>åŒæ—¶æ¥åˆ° <strong>Betaflight é£æ§çš„ UART RX</strong> å’Œ <strong>Arduino çš„ UART RX</strong>ã€‚</p>
</li>
<li>
<p><strong>é£æ§</strong>ç»§ç»­å’Œæ¥æ”¶æœºä¿æŒåŒå‘é€šä¿¡ï¼ˆæ¥æ”¶æœº RX â†” é£æ§ TXï¼‰ï¼Œè¿™æ ·é£æ§è¿˜èƒ½æ‹¿åˆ°å®Œæ•´çš„ CRSF é€šé“å’Œé¥æµ‹ã€‚</p>
</li>
<li>
<p><strong>Arduino</strong>åªç›‘å¬æ¥æ”¶æœº TXï¼Œä¸å¾€å›å‘æ•°æ®ï¼Œå°±ä¸ä¼šå’Œé£æ§å†²çªã€‚</p>
</li>
<li>
<p><strong>é€»è¾‘</strong>ï¼š</p>
<ul>
<li>é£æ§ ARM â†’ æ­£å¸¸é£è¡Œï¼ŒArduinoåªæ˜¯æ—å¬ã€‚</li>
<li>é£æ§ DISARM â†’ Arduinoè¯»å–é€šé“ï¼Œé©±åŠ¨åœ°é¢ç”µæœºå’Œèˆµæœº</li>
</ul>
</li>
</ul>
<p>âœ… è¿™å°±æ˜¯æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼šä¸€ä¸ªæ¥æ”¶æœºåŒæ—¶æœåŠ¡é£æ§å’Œ Arduinoï¼Œé£æ§è´Ÿè´£é£è¡Œé—­ç¯ï¼ŒArduinoåœ¨é£æ§é”å®šæ—¶æ¥ç®¡é€šé“åšåœ°é¢æ¨¡å¼ã€‚</p>
<h2 id="_1">ğŸ“Œ ç¡¬ä»¶ç»“æ„</h2>
<ul>
<li><strong>ELRS æ¥æ”¶æœº</strong>ï¼šè¾“å‡º CRSF åè®®æ•°æ®ã€‚</li>
<li><strong>Betaflight é£æ§ (BF)</strong>ï¼šé€šè¿‡ UART ä¸æ¥æ”¶æœºåŒå·¥é€šä¿¡ï¼ˆæ—¢æ¥æ”¶é€šé“ï¼Œåˆå›ä¼ é¥æµ‹ï¼‰ã€‚</li>
<li><strong>Arduino Mega2560</strong>ï¼šå¹¶è”ç›‘å¬æ¥æ”¶æœº TXï¼Œåªè¯»å–é€šé“æ•°æ®ï¼Œä¸å‚ä¸å›ä¼ ã€‚</li>
<li><strong>PCA9685</strong>ï¼šç”± Arduino æ§åˆ¶ï¼Œç”¨äºé©±åŠ¨åœ°é¢ç”µæœºå’Œèˆµæœºã€‚</li>
<li><strong>èˆµæœº Ã—4</strong>ï¼šå·¦å³æ”¶æ”¾ + å·¦å³é”å®šã€‚</li>
<li><strong>åœ°é¢ç”µæœº Ã—4</strong>ï¼šå·®é€Ÿé©±åŠ¨ã€‚</li>
<li><strong>é£è¡Œç”µæœº Ã—4 + ESC</strong>ï¼šç”± Betaflight æ§åˆ¶ã€‚</li>
</ul>
<hr />
<h2 id="arduinocrsf">æµ‹è¯•ä»£ç ï¼šArduinoè¯»å–CRSFé€šé“çš„å€¼</h2>
<pre><code>#include &lt;AlfredoCRSF.h&gt; Â  // ä½¿ç”¨ CRSF åº“

AlfredoCRSF crsf(Serial1); // Mega2560 çš„ Serial1 (TX1=18, RX1=19)

#define CH_MODE Â  Â  6 Â  // æ¨¡å¼æ‹¨æ†é€šé“ç´¢å¼•
#define CH_THROTTLE 0 Â  // æ²¹é—¨é€šé“ç´¢å¼•

void setup() {
 Â Serial.begin(115200); Â  Â  Â  Â  Â // ç”¨äºè°ƒè¯•è¾“å‡º
 Â Serial1.begin(420000); Â  Â  Â  Â  // CRSF æ³¢ç‰¹ç‡
 Â crsf.begin();
}

void loop() {
 Â crsf.loop(); // è§£ææ¥æ”¶æœºæ•°æ®

 Â // è¯»å–é€šé“å€¼ï¼ˆåº“é€šå¸¸è¿”å› 1000~2000ï¼‰
 Â int mode Â  Â  = crsf.getChannel(CH_MODE);
 Â int throttle = crsf.getChannel(CH_THROTTLE);

 Â // æ‰“å°åˆ°ä¸²å£ç›‘è§†å™¨
 Â Serial.print(&quot;Mode channel: &quot;);
 Â Serial.print(mode);
 Â Serial.print(&quot; | Throttle: &quot;);
 Â Serial.println(throttle);

 Â delay(50); // æ¯ 50ms æ‰“å°ä¸€æ¬¡
}
</code></pre>
<hr />
<h2 id="pca9685">èˆµæœºæ§åˆ¶ï¼š<strong>PCA9685èˆµæœºæ‰©å±•æ¿</strong></h2>
<h3 id="pca9685-03-pwm"><strong>PCA9685 é€šé“ 0â€“3</strong> â†’ å››ä¸ªåœ°é¢ç”µæœºé©±åŠ¨ PWM è¾“å…¥</h3>
<ol>
<li><strong>PCA9685 é€šé“ 4</strong> â†’ å·¦ä¾§æ”¶æ”¾èˆµæœº</li>
<li><strong>PCA9685 é€šé“ 5</strong> â†’ å³ä¾§æ”¶æ”¾èˆµæœº</li>
<li><strong>PCA9685 é€šé“ 6</strong> â†’ å·¦ä¾§é”å®šèˆµæœº</li>
<li><strong>PCA9685 é€šé“ 7</strong> â†’ å³ä¾§é”å®šèˆµæœº</li>
<li><strong>PCA9685 V+</strong> â†’ ç‹¬ç«‹ 5â€“6V BECï¼ˆä¸ºèˆµæœº/ç”µæœºä¾›ç”µï¼‰</li>
<li><strong>PCA9685 VCC</strong> â†’ Arduino 5V</li>
<li><strong>SDA/SCL</strong> â†’ Arduino Mega2560 çš„ SDA (Pin 20) / SCL (Pin 21)</li>
<li><strong>GND</strong> â†’ å…±åœ°ï¼ˆArduinoã€é£æ§ã€æ¥æ”¶æœºã€BEC å…¨éƒ¨å…±åœ°ï¼‰</li>
</ol>
<h3 id="_2">æ§åˆ¶é€»è¾‘ï¼š</h3>
<ul>
<li>
<p><strong>å¼€å…³ A (ARM)</strong>ï¼šé£æ§è§£é”/ä¸Šé”ã€‚</p>
</li>
<li>
<p><strong>å¼€å…³ B (MODE)</strong>ï¼šå½¢æ€åˆ‡æ¢ï¼ˆé£è¡Œ â†” åœ°é¢ï¼‰ã€‚</p>
</li>
<li>
<p><strong>èˆµæœº</strong>ï¼šå·¦å³å„ä¸€ä¸ªæ”¶æ”¾èˆµæœº + å·¦å³å„ä¸€ä¸ªé”å®šèˆµæœºï¼ˆå…±å››ä¸ªï¼‰ã€‚</p>
</li>
<li>
<p><strong>åœ°é¢ç”µæœº</strong>ï¼šå››ä¸ªç”µæœºå·®é€Ÿé©±åŠ¨ã€‚</p>
</li>
<li>
<p><strong>é€»è¾‘é¡ºåº</strong>ï¼š</p>
<ul>
<li>é£è¡Œæ¨¡å¼ï¼šé£æ§ ARMï¼ŒArduinoä¸å¹²é¢„ã€‚</li>
<li>åˆ‡æ¢åˆ°åœ°é¢æ¨¡å¼ï¼šå…ˆé”å®šé£æ§ â†’ èˆµæœºæ”¾ä¸‹/è§£é” â†’ Arduinoæ¥ç®¡æ²¹é—¨/è½¬å‘é©±åŠ¨åœ°é¢ç”µæœºã€‚</li>
<li>åˆ‡æ¢å›é£è¡Œæ¨¡å¼ï¼šèˆµæœºæ”¶èµ·/é”å®š â†’ å†å…è®¸é£æ§ ARM â†’ é£æ§æ¥ç®¡é£è¡Œã€‚</li>
</ul>
</li>
</ul>
<hr />
<h2 id="_3">å®Œæ•´ä»£ç ï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰</h2>
<pre><code>#include &lt;AlfredoCRSF.h&gt; Â  Â  Â  Â  Â  Â  Â // CRSF åº“ï¼Œç”¨äºè¯»å– ELRS æ¥æ”¶æœºé€šé“
#include &lt;Adafruit_PWMServoDriver.h&gt; Â // PCA9685 åº“ï¼Œç”¨äºæ§åˆ¶èˆµæœºå’Œåœ°é¢ç”µæœº

// åˆ›å»ºå¯¹è±¡
AlfredoCRSF crsf(Serial1); Â  Â  Â  Â  Â  Â // ELRS æ¥æ”¶æœºæ¥åˆ° Mega2560 çš„ Serial1 (RX1=19, TX1=18)
Adafruit_PWMServoDriver pca = Adafruit_PWMServoDriver(0x40); // PCA9685 I2C åœ°å€é€šå¸¸æ˜¯ 0x40

// é€šé“ç´¢å¼•ï¼ˆæ ¹æ®ä½ çš„é¥æ§å™¨æ˜ å°„ï¼‰
#define CH_ARM Â  Â  Â 5 Â  // å¼€å…³ Aï¼šé£æ§ ARM/é”å®š
#define CH_MODE Â  Â  6 Â  // å¼€å…³ Bï¼šå½¢æ€åˆ‡æ¢ï¼ˆé£è¡Œ/åœ°é¢ï¼‰
#define CH_THROTTLE 0 Â  // æ²¹é—¨é€šé“
#define CH_STEER Â  Â 1 Â  // è½¬å‘é€šé“

// èˆµæœºä½ç½®ï¼ˆæ ¹æ®æœºæ¢°ç»“æ„è°ƒæ•´ï¼‰
#define SERVO_GEAR_UP_US Â  1000 Â  // æ”¶èµ·è½®å­
#define SERVO_GEAR_DOWN_US 2000 Â  // æ”¾ä¸‹è½®å­
#define SERVO_LOCK_ON_US Â  1000 Â  // é”å®š
#define SERVO_LOCK_OFF_US Â 2000 Â  // è§£é”

// å»¶æ—¶ä¿è¯èˆµæœºåŠ¨ä½œå®Œæˆ
#define SEQ_DELAY_MS 800

// å½“å‰å½¢æ€çŠ¶æ€
enum ShapeState { SHAPE_FLY, SHAPE_GROUND };
ShapeState currentShape = SHAPE_FLY;

// ---------------- å·¥å…·å‡½æ•° ----------------

// å°†å¾®ç§’è½¬æ¢ä¸º PCA9685 çš„ tick å€¼
uint16_t usToTicks(int us) {
 Â float duty = constrain(us, 500, 2500); // é™åˆ¶èŒƒå›´
 Â return (uint16_t)(duty / 20000.0f * 4096.0f);
}

// PCA è¾“å‡º PWM
void pcaWriteUs(uint8_t channel, int us) {
 Â pca.setPWM(channel, 0, usToTicks(us));
}

// èˆµæœºåŠ¨ä½œï¼ˆå››ä¸ªèˆµæœºï¼šå·¦å³æ”¶æ”¾ + å·¦å³é”å®šï¼‰
void setGearUp() {
 Â pcaWriteUs(4, SERVO_GEAR_UP_US); Â  // å·¦æ”¶æ”¾
 Â pcaWriteUs(5, SERVO_GEAR_UP_US); Â  // å³æ”¶æ”¾
}
void setGearDown() {
 Â pcaWriteUs(4, SERVO_GEAR_DOWN_US); // å·¦æ”¶æ”¾
 Â pcaWriteUs(5, SERVO_GEAR_DOWN_US); // å³æ”¶æ”¾
}
void setLockOn() {
 Â pcaWriteUs(6, SERVO_LOCK_ON_US); Â  // å·¦é”å®š
 Â pcaWriteUs(7, SERVO_LOCK_ON_US); Â  // å³é”å®š
}
void setLockOff() {
 Â pcaWriteUs(6, SERVO_LOCK_OFF_US); Â // å·¦é”å®š
 Â pcaWriteUs(7, SERVO_LOCK_OFF_US); Â // å³é”å®š
}

// åœ°é¢ç”µæœºæ§åˆ¶
void stopGroundMotors() {
 Â for (int ch=0; ch&lt;4; ch++) pcaWriteUs(ch, 1000); // åœæ­¢å€¼
}

void driveGroundMotors(int throttle, int steer) {
 Â // ç®€å•å·®é€Ÿï¼šå·¦å³ç”µæœºåŸºç¡€ä¸Šå åŠ è½¬å‘åç½®
 Â int steerOffset = map(steer, 1000, 2000, -400, 400);
 Â int left Â = throttle - steerOffset;
 Â int right = throttle + steerOffset;
 Â left Â = constrain(left, 1100, 1900);
 Â right = constrain(right, 1100, 1900);
 Â pcaWriteUs(0, left); Â  // å·¦å‰
 Â pcaWriteUs(1, right); Â // å³å‰
 Â pcaWriteUs(2, left); Â  // å·¦å
 Â pcaWriteUs(3, right); Â // å³å
}

// ---------------- åˆå§‹åŒ– ----------------
void setup() {
 Â Serial.begin(115200); Â  Â  Â  Â  Â  Â  Â  // è°ƒè¯•è¾“å‡º
 Â Serial1.begin(420000); Â  Â  Â  Â  Â  Â  Â // CRSF æ³¢ç‰¹ç‡
 Â crsf.begin();

 Â pca.begin();
 Â pca.setPWMFreq(50); Â  Â  Â  Â  Â  Â  Â  Â  // èˆµæœº/ç”µæœº 50Hz

 Â // åˆå§‹çŠ¶æ€ï¼šé£è¡Œå½¢æ€ï¼Œèˆµæœºæ”¶èµ·é”å®š
 Â setGearUp();
 Â setLockOn();
 Â stopGroundMotors();
}

// ---------------- ä¸»å¾ªç¯ ----------------
void loop() {
 Â crsf.loop(); // è§£ææ¥æ”¶æœºæ•°æ®

 Â // è¯»å–é€šé“
 Â int armSwitch Â = crsf.getChannel(CH_ARM);
 Â int modeSwitch = crsf.getChannel(CH_MODE);
 Â int throttle Â  = crsf.getChannel(CH_THROTTLE);
 Â int steer Â  Â  Â = crsf.getChannel(CH_STEER);

 Â bool armOn = (armSwitch &gt; 1600); Â  Â  Â  // ARM å¼€å…³åˆ¤å®š
 Â bool modeGround = (modeSwitch &lt; 1400); // å½¢æ€å¼€å…³åˆ¤å®š

 Â if (armOn &amp;&amp; currentShape == SHAPE_FLY) {
 Â  Â // é£è¡Œæ¨¡å¼ï¼šé£æ§æ¥ç®¡ï¼ŒArduinoä¸å¹²é¢„
 Â  Â stopGroundMotors();
 Â } else if (!armOn &amp;&amp; modeGround &amp;&amp; currentShape == SHAPE_FLY) {
 Â  Â // åˆ‡æ¢åˆ°åœ°é¢æ¨¡å¼ï¼šå…ˆé”å®šé£æ§ï¼ˆarmOffï¼‰ï¼Œå†èˆµæœºåŠ¨ä½œ
 Â  Â setGearDown();
 Â  Â setLockOff();
 Â  Â delay(SEQ_DELAY_MS);
 Â  Â currentShape = SHAPE_GROUND;
 Â } else if (!armOn &amp;&amp; !modeGround &amp;&amp; currentShape == SHAPE_GROUND) {
 Â  Â // åˆ‡æ¢å›é£è¡Œæ¨¡å¼ï¼šèˆµæœºæ”¶å› â†’ å†å…è®¸é£æ§ ARM
 Â  Â setGearUp();
 Â  Â setLockOn();
 Â  Â delay(SEQ_DELAY_MS);
 Â  Â currentShape = SHAPE_FLY;
 Â }

 Â // åœ°é¢æ¨¡å¼ä¸‹é©±åŠ¨ç”µæœº
 Â if (currentShape == SHAPE_GROUND) {
 Â  Â driveGroundMotors(throttle, steer);
 Â }
}
</code></pre>
<hr />
<h2 id="_4">ğŸ“Œ æ¥çº¿è¯´æ˜</h2>
<ul>
<li><strong>æ¥æ”¶æœº TX</strong> â†’ Arduino RX1 (Pin 19) + é£æ§ UART RX</li>
<li><strong>æ¥æ”¶æœº RX</strong> â†’ é£æ§ UART TX</li>
<li><strong>Arduino SDA (Pin 20)</strong> â†’ PCA9685 SDA</li>
<li><strong>Arduino SCL (Pin 21)</strong> â†’ PCA9685 SCL</li>
<li><strong>Arduino 5V</strong> â†’ PCA9685 VCC</li>
<li><strong>PCA9685 V+</strong> â†’ ç‹¬ç«‹ 5â€“6V BECï¼ˆä¾›èˆµæœº/ç”µæœºï¼‰</li>
<li><strong>PCA9685 GND</strong> â†’ å…±åœ°ï¼ˆArduinoã€é£æ§ã€æ¥æ”¶æœºã€BECï¼‰</li>
<li><strong>PCA9685 é€šé“ 0â€“3</strong> â†’ å››ä¸ªåœ°é¢ç”µæœºé©±åŠ¨</li>
<li><strong>PCA9685 é€šé“ 4â€“5</strong> â†’ å·¦å³æ”¶æ”¾èˆµæœº</li>
<li><strong>PCA9685 é€šé“ 6â€“7</strong> â†’ å·¦å³é”å®šèˆµæœº</li>
</ul>
<hr />
<h2 id="_5">è¡¥å……</h2>
<p><strong>Arduino IÂ²C æ‰«æå™¨ä»£ç </strong>ï¼Œä¸Šä¼ åˆ° Mega2560 åï¼Œå®ƒä¼šè‡ªåŠ¨æ‰«ææ‰€æœ‰è¿æ¥åœ¨ IÂ²C æ€»çº¿ä¸Šçš„è®¾å¤‡ï¼Œå¹¶åœ¨ä¸²å£ç›‘è§†å™¨é‡Œæ‰“å°å‡ºå®ƒä»¬çš„åœ°å€ã€‚è¿™æ ·ä½ å°±èƒ½ç¡®è®¤ PCA9685 çš„å®é™…åœ°å€æ˜¯ä¸æ˜¯ <code>0x40</code>ã€‚</p>
<pre><code>#include &lt;Wire.h&gt;

void setup() {
 Â Wire.begin(); Â  Â  Â  Â  Â  Â  Â  Â // åˆå§‹åŒ– IÂ²C
 Â Serial.begin(115200); Â  Â  Â  Â // æ‰“å¼€ä¸²å£ç›‘è§†å™¨
 Â while (!Serial); Â  Â  Â  Â  Â  Â  // ç­‰å¾…ä¸²å£å‡†å¤‡å¥½
 Â Serial.println(&quot;\nI2C Scanner æ­£åœ¨è¿è¡Œ...&quot;);
}

void loop() {
 Â byte error, address;
 Â int nDevices = 0;

 Â Serial.println(&quot;æ­£åœ¨æ‰«æ I2C æ€»çº¿...&quot;);

 Â for (address = 1; address &lt; 127; address++) {
 Â  Â Wire.beginTransmission(address);
 Â  Â error = Wire.endTransmission();

 Â  Â if (error == 0) {
 Â  Â  Â Serial.print(&quot;å‘ç°è®¾å¤‡ï¼Œåœ°å€: 0x&quot;);
 Â  Â  Â if (address &lt; 16) Serial.print(&quot;0&quot;);
 Â  Â  Â Serial.print(address, HEX);
 Â  Â  Â Serial.println(&quot; !&quot;);
 Â  Â  Â nDevices++;
 Â  Â } else if (error == 4) {
 Â  Â  Â Serial.print(&quot;æœªçŸ¥é”™è¯¯ï¼Œåœ°å€: 0x&quot;);
 Â  Â  Â if (address &lt; 16) Serial.print(&quot;0&quot;);
 Â  Â  Â Serial.println(address, HEX);
 Â  Â }
 Â }

 Â if (nDevices == 0) {
 Â  Â Serial.println(&quot;æ²¡æœ‰å‘ç° I2C è®¾å¤‡\n&quot;);
 Â } else {
 Â  Â Serial.println(&quot;æ‰«æå®Œæˆ\n&quot;);
 Â }

 Â delay(5000); // æ¯ 5 ç§’æ‰«æä¸€æ¬¡
}
</code></pre>
<ol>
<li>æŠŠ PCA9685 æ¥åˆ° Arduino Mega2560 çš„ <strong>SDA (Pin 20)</strong> å’Œ <strong>SCL (Pin 21)</strong>ã€‚</li>
<li>ä¸Šä¼ ä»£ç åˆ° Mega2560ã€‚</li>
<li>æ‰“å¼€ä¸²å£ç›‘è§†å™¨ï¼ˆ115200 baudï¼‰ã€‚</li>
</ol>
<hr /></main>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const body = document.body;
        const btn = document.getElementById("toggle-toc");
        const nav = document.querySelector("nav");
        const root = document.documentElement;

        // æ ¹æ®ç›®å½•å®é™…å®½åº¦åŒæ­¥ CSS å˜é‡ï¼Œç¡®ä¿æ­£æ–‡è®©å‡ºç©ºé—´è¶³å¤Ÿ
        function syncTocWidth() {
            // ä½¿ç”¨ offsetWidth åŒ…æ‹¬è¾¹æ¡†ä¸æ»šåŠ¨æ¡å®½åº¦
            const w = nav.offsetWidth;
            // æœ€å°å®½åº¦ä¿æŠ¤ï¼Œé˜²æ­¢å­—ä½“å°šæœªåŠ è½½æ—¶å€¼ä¸º 0
            const width = Math.max(w, 240);
            root.style.setProperty('--toc-width', width + 'px');
        }

        // åˆå§‹å±•å¼€å¹¶åŒæ­¥å®½åº¦
        body.classList.add("toc-expanded");
        // å¤šæ¬¡è§¦å‘ï¼Œè¦†ç›–å­—ä½“åŠ è½½ä¸æ¸²æŸ“æŠ–åŠ¨
        requestAnimationFrame(syncTocWidth);
        setTimeout(syncTocWidth, 0);
        setTimeout(syncTocWidth, 200);
        window.addEventListener('resize', syncTocWidth);

        // æŠ˜å /å±•å¼€åˆ‡æ¢ï¼ŒåŒæ—¶å†æ¬¡åŒæ­¥å®½åº¦
        btn.addEventListener("click", function() {
            body.classList.toggle("toc-collapsed");
            body.classList.toggle("toc-expanded");
            // å±•å¼€æ—¶æ‰éœ€è¦è®©å‡ºç©ºé—´ï¼›æ”¶èµ·å main å·²ç”¨ 1em
            syncTocWidth();
        });

        // æ‡’åŠ è½½å›¾ç‰‡
        const imgs = document.querySelectorAll("img[data-src]");
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    observer.unobserve(img);
                }
            });
        }, { rootMargin: "200px" });
        imgs.forEach(img => observer.observe(img));

        // ç›®å½•æŠ˜å ï¼šä»…æœ‰å­é¡¹çš„ li å¯æŠ˜å 
        document.querySelectorAll(".toc li").forEach(li => {
            const childUl = li.querySelector(":scope > ul");
            if (childUl) {
                li.classList.add("has-children");
                const a = li.querySelector(":scope > a");
                li.addEventListener("click", function(e) {
                    if (e.target.tagName.toLowerCase() === "a") return;
                    li.classList.toggle("open");
                });
                if (a) a.addEventListener("click", function() { li.classList.toggle("open"); });
            }
        });
    });
    </script>
    
</body>
</html>
